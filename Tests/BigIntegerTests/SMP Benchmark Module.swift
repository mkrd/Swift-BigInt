/*
	————————————————————————————————————————————————————————————————————————————
	SMP Benchmark Module.swift
	————————————————————————————————————————————————————————————————————————————
	Created by Marcel Kröker on 23.09.16.
	Copyright (c) 2016 Blubyte. All rights reserved.
*/
@testable import BigInteger

func benchmarkBInt()
{
	//SMPBenchmarkMatices()
	//SMPBenchmarkBDoubleConvergence()
	SMPBenchmarkFactorial(of: 25_000)
	SMPBenchmarkExponentiation(10, pow: 120_000)
	SMPBenchmarkFibonnacci(100_000)
	SMPBenchmarkMersenne(to: 256)
	SMPBenchmarkPermutationAndCombination()
	SMPBenchmarkBIntToString()
	SMPBenchmarkStringToBInt()
}

#if false
private func SMPBenchmarkMatices()
{
	let A = Matrix<BDouble>(
		[[2,5,-2],
		 [3,5,6],
		 [-55,4,3]]
	)

	let G12 = Matrix<BDouble>([
		[0.8,	-0.6,	0.0],
		[0.6,	0.8,	0.0],
		[0.0,	0.0,	1.0]
		])


	let al = Matrix<BDouble>([4, -3, 1])

	print(G12 * al)

	let (L, R, P, D) = LRDecompPivEquil(A)

	print(solveGauss(A, [2.0, -4.0, 15.0]))
	print(solveLR(A, [2.0, -4.0, 15.0]))
	print(solveLRPD(A, [2.0, -4.0, 15.0]))

	print("P L R")
	print(P)
	print(L)
	print(R)

	print("LR == PDA")
	print(L * R)
	print(P * D * A)


	benchmarkPrint(title: "Matix ^ 100")
	{
		var R = A
		for _ in 0...100
		{
			R = R * A
		}
	}
}
#endif

private func SMPBenchmarkBDoubleConvergence()
{
	benchmarkPrint(title: "BDouble converging to 2")
	{
		// BDouble converging to 2 Debug Mode
		// 06.02.16: 3351ms

		var res: BDouble = 0
		var den: BInt = 1

		for _ in 0..<1000
		{
			res = res + BDouble(BInt(1), over: den)
			den = den * BInt(2)

		}
	}
}

private func SMPBenchmarkFactorial(of n: Int)
{
	benchmarkPrint(title: "Factorial of 25000")
	{
		// Fkt 1000  Debug Mode
		// 27.01.16: 2548ms
		// 30.01.16: 1707ms
		// 01.02.16: 398ms

		// Fkt 2000  Debug Mode
		// 01.02.16: 2452ms
		// 04.02.16: 2708ms
		// 06.02.16: 328ms

		// Factorial 4000  Debug Mode
		// 06.02.16: 2669ms
		// 10.02.16: 571ms
		// 28.02.16: 550ms
		// 01.03.16: 56ms

		// Factorial 25000  Debug Mode
		// 01.03.16: 2871ms
		// 07.03.16: 2221ms
		// 16.08.16: 1759ms
		// 20.08.16: 1367ms

		_ = fact(n)
	}
}

private func SMPBenchmarkExponentiation(_ n: Int, pow: Int)
{
	benchmarkPrint(title: "10^120_000")
	{
		// 10^14000 Debug Mode
		// 06.02.16: 2668ms
		// 10.02.16: 372ms
		// 20.02.16: 320ms
		// 28.02.16: 209ms
		// 01.03.16: 39ms

		// 10^120_000 Debug Mode
		// 01.03.16: 2417ms
		// 07.03.16: 1626ms
		// 16.08.16: 1154ms
		// 20.08.16: 922ms

		_ = BInt(n) ^ pow
	}
}

private func SMPBenchmarkFibonnacci(_ n: Int)
{
	benchmarkPrint(title: "Fib \(n)")
	{
		// Fib 35.000 Debug Mode
		// 27.01.16: 2488ms
		// 30.01.16: 1458ms
		// 01.02.16: 357ms

		// Fib 100.000 Debug Mode
		// 01.02.16: 2733ms
		// 04.02.16: 2949ms
		// 10.02.16: 1919ms
		// 28.02.16: 1786ms
		// 07.03.16: 1716ms

		let n = fib(n)

		print("Fib 100.000 size: \(n.rawValue.limbs.count) limbs")
	}
}

import Foundation

/// Find all mersenne primes up to 2^n.
private func SMPBenchmarkMersenne(to n: Int)
{
	benchmarkPrint(title: "\nMersennes to 2^\(n)")
	{
		// Mersenne to exp 256 Debug Mode
		// 02.10.16: 1814ms

		print("Mersenne exponents:", terminator: " ")

		for i in 1...n
		{
			if isPrime(i)
			{
				if isMersenne(i)
				{
					print(i, terminator: ",")
				}
			}
		}
	}
}

private func SMPBenchmarkPermutationAndCombination()
{
	benchmarkPrint(title: "Perm and Comb")
	{
		// Perm and Comb (2000, 1000) Debug Mode
		// 04.02.16: 2561ms
		// 06.02.16: 2098ms
		// 07.02.16: 1083ms
		// 10.02.16: 350ms
		// 28.02.16: 337ms
		// 01.03.16: 138ms

		// Perm and Comb (8000, 4000) Debug Mode
		// 07.03.16: 905ms
		// 07.03.16: 483ms

		_ = permutations(8000, 4000)
		_ = combinations(8000, 4000)
	}
}

private func SMPBenchmarkBIntToString()
{
	let n = fact(7500)
	benchmarkPrint(title: "Get 7500! as String")
	{
		// Get 300! (615 decimal digits) as String Debug Mode
		// 30.01.16: 2635ms
		// 01.02.16: 3723ms
		// 04.02.16: 2492m
		// 06.02.16: 2326ms
		// 07.02.16: 53ms

		// Get 1000! (2568 decimal digits) as String Debug Mode
		// 07.02.16: 2386ms
		// 10.02.16: 343ms
		// 20.02.16: 338ms
		// 22.02.16: 159ms

		// Get 3000! (9131 decimal digits) as String Debug Mode
		// 22.02.16: 2061ms
		// 28.02.16: 1891ms
		// 01.03.16: 343ms

		// Get 7500! (25809 decimal digits) as String Debug Mode
		// 01.03.16: 2558ms
		// 07.03.16: 1604ms
		// 07.03.16: 1562ms
		// 16.08.16: 455ms

		let str = n.description
		print("7500! digits: \(str.characters.count)")
	}
}

private func SMPBenchmarkStringToBInt()
{
	var fromStr: BInt = 0
	let asStr = "26839997657267395961163166474627355122050186046884725685824261445661070965868578859479409748346329836182703089128852632609939583160469201526637034786976396625075825887529584878861523984702266296018595427551580174654216923424895644549809732165397549500287960097044436776098097112285935902002318300817766074944639865419157280524790653203290253917356133633993978535760253069357555142219669129998317026518032402810751448010557484004254745274140263837210122325107062378927575415179640798325598920907738968963426553833519168033920097139867697345016081563676374441238664213080213666256929097791375199485350231595456497900149202746728755327879812971546373369370677385700341673192285360910112728679385205719710580583641371671892447976818829243817888754721448962887123232268424960754147650482415903026606790467209849563662271416952282649322598751397802523984319920253594583722082455006753362159905925741054970039726329277310783778301896111639647389105189524695731748039744831330171194849813750142198591661331367731897270827642663650121154179844927245869455452866090540869550194618984743649127756540595329147696682931012739858611204283134522143082978255200048338318229115382675077435011021122203657208296645354100711784246537108376427936888332083853865732544562471022466209428262367892766813822586238730884186670640599681155203053263579261264327036948384088756702762253306671361116697006843642834443792187068184967415329762543330480264694132001091536593658869788389814480927116885215169756787073551910689019283750895017493228111116730310828166766041200531056382164323390539713295116741388483967745305691786537941332339818667917676571370007419397773475261943894514052312932289624661769878012350676494947730866831924804552851197759345191254081631464738416269147789847963818212281155896550427170387285980460490951645441243497814514002972833731020681426095160149778141037573688491521442522428544788969389558278761397481348218877157739113180534110050023212126419438699172726154425655036249509154341846353246115757571655397172997888622515217725681355507009805113242461343462749671452788638077124750445775923725491807857904696015889810582915109267213212215315203713159208649674164979719727312920576511559196470602174361303899231649894912510856185814740917226239172072546201539584906050452246863211300948544262550662310529984226992582651085151214806862737544037624184170092436908438597773909311650839302124106743539756133701430549822835175979119647543081774334757846025648778275567966409017115828239278838608964398135300219592308860564771741370352802721328544196035203258913677288304583292026902650292022615233949477454247380613913727205962978808266843078181782521529295663178723309967551512319985570114605975081675370544606833051518171905908225228981315998888508641383754110684161710540379573862750847847505118932108687343116259504882707915331968334989766476215094439032763933829258296825600807659383396331656916379451344784802449899227776335723347766390689666241963170367393391210821232042808302473264063265570110727719831475689561404967877066430429903848880193864377881446218231571439631758568428463947148118858717809903748434222683956452043663618862381077166736163904143611771876372531590296726023035330673799952066924105529602223046628759245420801826722083980921568005211239250818157044712443998577051201694386666676548459139059534955603452332498091561411572853622851267073396054099014969366801494527706537595304138848480664476770533265090362642331386328673912578619209255162812445589840156651576378448310470200887299943392878434964998167663977882887221263096306624719352570216017537901919095997174491423825076915901844828299728867068358932893173855581339383152432283675932309139108086846506216370866033080621523840531146755934097307408215697024409051687603668777226806830415433795410593140890416931031058084357039568102702638999494225749379427539899477901253728525589333527959277554441588267988641971876672848522278885432950000713174717818564119905187925226030650056997215832606755915139333987912157419842331744288642889962577622559173461092061337782792800669889998655960852746942113164577327334884576755813786481634749877236127180350856907734255684011438108061579128976722956572293429802773951504460935383493894278312699763923245547175663397346989022015320010667525912457679400581483705019548056855672703674896854737678203776369140756376089462449280006665661035666006921950987386872094427675301957693502233910568049172906194746954125886626269172858815989476855674311523872846329821400400763827646130537527272350995090929517107381022804145383611938945290186877390668234661029799097681602379568029119838560091291614083678024113699512262414222827129371338079435110215172704049731560918699244509728283556069827037741673013342110878227016581208632447654168805338374785489229037504121557638213364969795134613946880198143598744934254049047652000435648260460315689718953671559931084783230022864563599174390561242416515649909885274704141042481089882030312456111711513802717240135242476854435918803605162485964256860285707437162161523150880602244588082288703552459412578484347249931541710133937268355470525564025317366479302263333297793229701722268518487745423309476454825885688563656328669909328960726227217746513974012608523837157894646126497155495847558779670772281055345753896529609284835447408379437232766596325245729441678426804018266486446041738028201210588974259726818731212691907209410450960012489269359303557141418261872878840153018432632743047491241142213154307261531976744986085767078659204961267418144728791274812585877377270787860181952296269435846032835432665015604490686890958244706686381824599477501861516682019378871555372510865803678658691697941102766320731311969158487304120286437862145736732394203678256089895044788570688165095904488684541547213265814760800903192224668435587633646241787956794671777024535537548677669344734391033706602943613442496123847673685078921583639566511433247002826913206025495210184332820453059341772597886542104466355672414361321525270662898671590256225316736799329288004282209029227977496988338803694599926602334918886851384115767529046261566167879067415004412013981026431670302781024110519975053809251441552664436695119607254616839235405097220832844999496406932610321750880717707526257155144479558265577121457883354130966058460949905183541920784685810495511824633564623203622545752285048322601540147114940477282319089885604719594322274307570377569828497611795106065649907604825505236501660518162575599118468736316043306834159987187831281295962021538609891359958084877685159675050166947628016488026431953172281900387230968173782146563168653588630286211011668433441333823075581919363824362932880427831430556053108507046246421196140219366978834558974462588436923645529385600025541518596699322797933616685250622157597463243707453327414164942163090126405769853433010109206938295039098203538385660049440677153410981199879428054550229069777536610109500673593952523016334494523561068250729979121779184363748140628442779681000417566359474204167681174820176728969043370649673522631060265357110075973952347360362984289840155659432230548753561511108669634362621654405756411713538358908721730705960390405977938491036511919613427919440128566811728681598359611378946010125676443438082247070490023185084235213042639811189709583244714164597763501116307625848095008701493449513079965992954097684158860941655430946986067589018614170778141474686227232765295039894254082902355866495212825729079245813851076586228786055451349969723070416315974239445690393038118202725795105519781134231015178521890424346496650894181117354609245262021371137195676841189511521902507335137574217501870437614126135353094126084804313051200792975952140413789628883243769036385641778001621627161816525820367941544906943954307963287899647807608555063949916962195279711901809586155318819699397668051655460229580017948563694384203283404278464809965543259459238690367209746182768863741318400635630079422528479763675001256831936882203374586645618033291782515494021505175038624781840272794622469978853958785054623954499516285871397211907425386069707751534411059083177014806958625176529207667888992864932992747415768392548848256304173508923017783002188862774976889301189512631658135171879154140083392136382819310890513335161935706439544652866330201623448052563814824077603326355508933605604424600448291508530124857820023813927063948608641347736250592506112490756973272230629775646381758420315977437335059628471695549795691293756712366294481331175001245733081851145135484800803418840241315976099255095439620940223136901994965329154153506574920570848498252125571529713557668092811195646136559978088820601346208029112370733158792968907458126312371445670688267987605112516475243208816963302038466447547681765253439647124033397270561625609556398590434964457944954309646474894650904853218921957202959530304641111659297682838865324856282312400884964347702070305433879310515186656471481638169102808581722273535412432597450682370732570982895174461945607104365181581376611951264796184795738549839706427908331191819986570317688182995627653773550817877954776508879127635456487418504926881654920604279454152324325660886511272516911299135838141087303316226745988807478038370462171963678341308873095934247673904776115988991225795671253759564756119735443325022586469345409028644380587414699081655676862737273868437940818179561003406992360965199467481546972908696465933739781519701659242335232356415466038443338391940395961378869736803878457355977659711442530839903609720790079863076058058715425763090531370117042825661461468549528115981158562216417882781509664853084610831510279505043600822370480590602567198336194062784913269731422406383973451453248248130283541310749558344183861427625568458608812548097423428774920090092328407439640342723637863396368920858582855416845188111542427327700990645690098745755247279065598056279137864634712015208857329539219829853397466428466858279087009752509271828426898571834909681863109405566656445800488441033946511794342431604565168864967057267397568220363992954730588476055451427487747065978279654894963593073322993554421804132579318498274537173107483494533189509118093004443180291631727515000642142157865267493042953936254541488985234518070473671110935727926968656415152473303726109624468629752844760557073833637378230650501221082633697198807510860468850341272344748512661777090799274894787545289009052176976539368742406207723182280541002309464890868562316823514637242729903960306443521003257332856088639395551668126821383301629329766797786756596435530484560778049737215792030674205303205801908027014371344418997505156595085966936182094633009369957887739382905617186959592994679436161215891491201560010002303562861512545655665533747304126090814958091971128086726263385122624660641970132348294803564477594695720793602492116938354646938946023345419380616330196587711018244015684782598722707267350042318261118692659787623138728964220486865730904538203308544993585204324572483911221951329505157910024779477100406637724879026557148888479697973570421165075760846187884313379621653231257431521388920581117855569927930918809429389097758561316947040253818657366569583216996595880452085181969727435761566711982292456039046952519493321075973470394810159148251758971126592230257412888072670817718837506735539095364155132814201524878117711434829903313602637604260588611935665177670745833721998953303904895239132068265377922420627009779809889466755971872455555671343784690265355346881170795850018502852129370131161465211107369431679795035652082821361480112682380161016649435674734177637483728801571862040064044726291609723825892762153360165674913318950680706277824100457440373632584431075427676529506977563628228527378494844207021130124323451315757493502535786767998535944780419236802727365935448267569554728569057360166647462125575250193177849662065112241470787761620611464498899026682166757218791373813761401747102822467889867257511968031588511731267040532584303876277822386722669253577220369208701354730560681156009035093927791766748395744314207149124473135012255460731267410179450581153432937372865433287334462578361944819245261635417883590093899730240806210512987059139039755719239516747955096168654356635774845296249238132200083290844308330305768505442081037956814356669229273485720031048841792343104465806889538587267438148348731529650107764155019749250703132742148481239788685811391010900182490909954694363129618125365471934712122838075498656865915837228681461906354109534852326705549753619056082390581591133714455250473306727306242271394575288348548899421857457448892069402326062432879273585649517014441861740184183732637647917145400133596746174058308263937278934908107861989223858703458125139822476496470077529071243260203480002394510173588464682577409130875845159623990027664682239590745295239264283065594285434091436489253442921825135707791449628982248064677091483840909115145896107493834857848808071214338290234872083621079923598950627418060690376874046447264041880157359247953759911121569430096089834446296806860114670291023641209580290186092260745512341049839125320156048602734609882451486484322548326755005290081487345389836313565927731311793288362110072115999613152199117256916818999608708250621912549461311254907765260632070362318972418308599585793874193787083482250701523909384993325593106521905136810593360648610894682072245554224301126571410508286122161010810045817773370919374379062289989596224173452184331945051277917796601154892023168491463596096169598616821643671175696854206049100409006169078167430243904473349850147863726706105693676072525164576151294211311629974748183761004606695897909323902577614980463372076919222259328236178404969041379181515374344242733626249558454232062869892488352165799933907917509540768234595160387324388181683690007433113673985430304052495927693685462083670005908633301178630874993739635956858976116348960179166726796605516490861400434448117862153583360984970496289282786486924122320805439939104334341019564178399582455126220556116076741160779832290603975886951147801032161856144959140749293512916086914534660610841694647041611561923866814230934483566399542264717552387574974421387272230796502177946284221874524930330498681663359921010552038845486760571928329559123276961732134968947802118912623447421785908853884067148125440069829365065220130190616955378432426153891483828105402950511840637876877234184400942653059494517924357669899733289658380086660623384775909557622020560227651865360538523553843745107362962392805230202092309660311635156423561540681110235178761462251944120644292834726236559729720149026752335625188787684395265448115729660748799089328448221254102231043203399148743725714335765832853961835178566475440498860100869638052637605743373122008063627879684909029232858931089061916343578608313417391750989970302069749103922130012341608004119286343965424842059261793368728098393595453691033567327108159117557620000953888329412084429827988048791349759502464645602759589914538960491613793478214629274343372792133917392650045082328532754264581760884356541693444000522135818927662083734901101455655254750765419245440999083696076591953649097658590724853350795572415019126863241169128496172523992207344038102394497164800269534560712698912118761394346980783745339986140508718446774224385072467747565302711974864997611631470554269949908627401966447196716914845339410483869892524887982754042429506250673628968228718414012061643077451598342070312729529554773622909551294617485271223447001479812256152081338761827213750484285102947543191716410061394064195110279165734257137718743900404114109584078987879890440446197685164429076990775186914399945755358951691014258339827760688101039687288938837826076976979306089014797721238103646612279704260840216938322762615799981033899782421339230193365498507592907351317381230515558484120284158045864263284108686716827733330001944050406926490472871149620911685246815731101319508907675308813751230736133469124878367785484098823175312278896475273717682187775471894949719361716988670517703295238021800981249818686821379075877402467161140894884709253873700243744595822568080593124662675402754125916201532030537520491201173394159061364948483059596580316726712605307448924989087569963854988789985035890309396965302398195067375747112091617600630569062324899570087096741838973750680880832943381845733445043322194272393030455106292621745244865065398232650227634039186524858034442435811685990620469599080320964512829736284194196458596854413094883125022632141852377393629837683566291882367008185503452296814405791004709850786420099334456302025779045784575829371702458061571747687640159115139743805106923198622400343083944895587534294586812991787254524635520715077762098659988456250623733754110464719122690522791780240030691459123414760105186968091990914114056819616384834492304501039162508627073767169780478967830496186463014833978072637257898856860747927869572485404472280339434886585112737960619322714849939180667763616427956312853138705840775032899047093993945041239132207332617958940173285759309420189320639459634009108821270840450430079776452768788377382406303880576440235086778433484851147247590306073275962761489160541273044410581057507318552527566462489287493173796287417367511276543141860934682205107397952449995571915189415486555443905015245009447583374122394632411846254123646430760547330754177908127719307103338704379090318774174414339548060789758654183769135018414808654059391380421542898999289131982752881304432914119165614021131474301910193653981743294360179900258947239179416931113274497477055056916721815325178771881770427595574526979969110609812671390052073967371528725049419557297254899779063252161056890215846180637435165931765123585887180135444817679943914033515786523995512366445378614290524518063186195499410292577340893661060140730842547355544924489906477904545600765784171496375614289338782329243001810188831870754174818902702669589149513609444235544045909168745079904116721850001084293630774744710684207973526258512853651361135504092112982975885188330480138649740482126293824415540863298341430414394251739591197379088280472305756923345573771556994641103276622032051635549987509769751669795304800617960120841579720909823273146247520919870094496829700346067978778444534370898712922626727560847873952959479373409336411773191732428874668314482333129065714938545538758040915539353017303882622304962799500823467650949423108117514476739529568772483484088052527412492835298965051496826879243767284255331909921087629905226018279220902892396229790261576968836481928703175145314086183266916645372130046603087776005949156839867209518985438312000494875144235247146892718470881434056042405573649073820901746077355841968175323686311247214811449866295517680784346062675700080180133241281272872960000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"


	benchmarkPrint(title: "BInt from String, 20066 digits (6000!)")
	{
		// BInt from String, 3026 digits (1151!) Debug Mode
		// 07.02.16: 2780ms
		// 10.02.16: 1135ms
		// 28.02.16: 1078ms
		// 01.03.16: 430ms

		// BInt from String, 9131 digits (3000!) Debug Mode
		// 01.03.16: 3469ms
		// 07.03.16: 2305ms
		// 07.03.16: 1972ms
		// 26.06.16: 644ms

		// BInt from String, 20066 digits (6000!) Debug Mode
		// 26.06.16: 3040ms
		// 16.08.16: 2684ms
		// 20.08.16: 2338ms


		fromStr = BInt(asStr)
	}

	assert(fact(6000) == fromStr)
	assert(asStr == fromStr.description)
}
